# To‑Do List App – Product Requirements & Technical Specification

---

## 1️⃣ Product Requirements Document (PRD)

### 1. Vision & Problem Statement

People need a friction‑free way to capture, organize, and complete tasks across devices. Existing tools are often bloated, expensive, or lack privacy controls. **Our vision:** a lightweight, open‑source to‑do list that is **delightful, secure, and extendable**.

### 2. Goals (v 1.0)

| #   | Goal                        | KPI                        | Target   |
| --- | --------------------------- | -------------------------- | -------- |
| G‑1 | Quick capture in ≤ 2 clicks | Avg. time‑to‑create        | ≤ 5 s    |
| G‑2 | Cross‑device sync           | Sync latency               | ≤ 500 ms |
| G‑3 | Zero onboarding friction    | Guest‑to‑signup conversion | ≥ 30 %   |
| G‑4 | Accessibility AA            | WCAG 2.2 score             | 100 % AA |

### 3. Non‑Goals

* Native desktop clients (v2)
* Team collaboration / sharing (v2)
* Recurring tasks (v1.1)

### 4. Personas & Jobs‑to‑Be‑Done

* **Maya, 24, Student** – wants to jot homework tasks on‑the‑go.
* **Ravi, 31, Product Manager** – needs rapid inbox‑zero each morning.
* **Anne, 46, Privacy‑conscious user** – wants local‑first data with encrypted cloud backup.

### 5. User Stories & Acceptance Criteria (excerpt)

| ID   | As a…          | I want to…                     | So that…                    | Acceptance Criteria                                              |
| ---- | -------------- | ------------------------------ | --------------------------- | ---------------------------------------------------------------- |
| US‑1 | visitor        | create a task without account  | I can try the app instantly | "Add Task" works with localStorage, no signup gate               |
| US‑2 | logged‑in user | mark a task complete           | track progress              | Checkbox toggles `completed_at` timestamp, UI updates in <100 ms |
| US‑3 | user           | filter tasks (All/Active/Done) | focus on next actions       | Filters persist in URL query params                              |

### 6. Feature List (v 1.0)

1. Quick‑add input (keyboard + mouse)
2. Edit, delete, complete, reorder (drag‑and‑drop)
3. Filters (All | Active | Completed)
4. Auth: email‑password & OAuth (Google/GitHub)
5. Sync across web & PWA (Service Worker)
6. End‑to‑end encryption at rest
7. Offline‑first with optimistic updates
8. Settings panel (theme, data export / import)

### 7. Non‑Functional Requirements

* **Performance:** Time‑to‑Interactive ≤ 1 s on 3G.
* **Scalability:** 10 k active users, 1 M tasks.
* **Security:** OWASP ASVS level 1.
* **A11y:** WCAG 2.2 AA.
* **L10n:** RTL & i18n‑ready (EN default).

### 8. Success Metrics & Analytics

* WAU/MAU ratio, task‑creation funnel, average tasks‑per‑user, error rate (Sentry).
* Privacy‑first analytics (e.g., Plausible, PostHog self‑hosted).

### 9. Dependencies & Risks

* Third‑party auth outages ➜ fallback magic‑link auth.
* IndexedDB quota limits on Safari ➜ periodic cleanups.
* GDPR compliance ➜ Data Processing Agreement w/ host.

### 10. Roadmap (T‑shirt sizing)

| Phase | Scope                             | ETA    | Notes                      |
| ----- | --------------------------------- | ------ | -------------------------- |
| MVP   | Core CRUD, guest mode, email auth | +4 wks | Launch to limited beta     |
| v1.1  | Recurring tasks, reminders        | +3 wks | Requires scheduler worker  |
| v2    | Sharing & collaboration           | TBD    | Real‑time cursor, comments |

---

## 2️⃣ Technical Specification

### 1. Architecture Overview

```
Browser ↔ Service Worker ↔ Web App (Next.js 14, React 19) ↔
┌───────────────┐        REST/GraphQL      ┌────────────┐
│ Edge Functions│  ←─────────────────────→ │  Postgres  │
└───────────────┘                          └────────────┘
      ↑                                         ↑
   Auth0 /                                       |
   NextAuth                                      |
      │                                      Hasura (optional)
   OAuth2 /                                       |
   Email Link                                 Row‑level Security
```

* **Frontend:** Next.js App Router + React Server Components.
* **State:** `zustand` + `react‑query` for server cache.
* **Backend:** Node 18 (tRPC router) **or** Edge‑runtime (Vercel/Cloudflare).
* **DB:** PostgreSQL 15 with `uuid` PKs, row‑level multitenancy.
* **Offline:** Service Worker + IndexedDB (Dexie).
* **Real‑time:** WebSockets via `socket.io` **or** Supabase Realtime.

### 2. Data Model (simplified)

| Table   | Field         | Type                       | Constraints                |
| ------- | ------------- | -------------------------- | -------------------------- |
| `users` | id            | uuid PK                    | generated by auth provider |
|         | email         | text UNIQUE                | NOT NULL                   |
| `tasks` | id            | uuid PK                    |                            |
|         | user_id       | uuid FK→users.id           | ON DELETE CASCADE          |
|         | title         | varchar(255)               | NOT NULL                   |
|         | notes         | text                       | NULL                       |
|         | status        | enum('active','completed') | DEFAULT 'active'           |
|         | order_index   | int                        | NULL                       |
|         | due_date      | timestamptz                | NULL                       |
|         | completed_at  | timestamptz                | NULL                       |
|         | created_at    | timestamptz                | DEFAULT now()              |

### 3. API Design (REST example)

| Method | Endpoint         | Payload    | Response     | Auth         |
| ------ | ---------------- | ---------- | ------------ | ------------ |
| GET    | `/api/tasks`     | —          | 200 `Task[]` | Bearer       |
| POST   | `/api/tasks`     | `{title}`  | 201 `Task`   | Bearer/Guest |
| PATCH  | `/api/tasks/:id` | `{status}` | 200 `Task`   | Bearer       |
| DELETE | `/api/tasks/:id` | —          | 204          | Bearer       |

> **GraphQL alternative:** schema with `task(id)` query, `createTask`, `updateTask`, `deleteTask` mutations.

### 4. State Management Flow

1. UI dispatches `addTask(title)`.
2. Local optimistic insert in Zustand store & IndexedDB.
3. tRPC mutation fires ➜ Edge Function ➜ DB.
4. On success ✅ → mark persisted; on error ❌ → rollback & toast.

### 5. Component Breakdown (Atomic)

| Layer         | Component                                        | Notes                     |
| ------------- | ------------------------------------------------ | ------------------------- |
| **Pages**     | `<HomePage>`                                     | Suspense for task list    |
| **Organisms** | `<TaskList>`, `<FiltersBar>`, `<SettingsDrawer>` |                           |
| **Molecules** | `<TaskItem>`, `<AddTaskInput>`                   | Drag‑handle via `dnd‑kit` |
| **Atoms**     | Checkbox, Button, Input                          | From ShadCN UI            |

### 6. Security

* JWT with 15 min TTL + sliding refresh.
* Helmet, CSRF cookie for POST forms.
* SQL injection via prepared statements, ORM `Drizzle`.
* Content‑Security‑Policy: script‑src 'self' vercel.app \*.

### 7. Performance & Reliability

* Lighthouse PWA score ≥ 90.
* Prefetch queries in RSC.
* Rate‑limit 100 req / IP / min (Cloudflare Turnstile).
* Daily pgbouncer backups + PITR.

### 8. Testing Strategy

| Layer       | Tool                            | Coverage Target  |
| ----------- | ------------------------------- | ---------------- |
| Unit        | Vitest + Testing‑Library        | 90 % functions   |
| Integration | Playwright                      | CRUD happy path  |
| E2E CI (PR) | GitHub Actions → Vercel Preview | green build req. |
| Manual      | a11y (axe), Keyboard nav        | each release     |

### 9. CI/CD & DevOps

* **CI:** GitHub Actions ➜ lint (`eslint`), type‑check (`tsc`), test, build.
* **CD:** Automatic deployment to Vercel Preview; `main` → production.
* **Infra as Code:** Terraform (optional) for DB & secrets.
* **Monitoring:** Vercel Analytics, Sentry, Uptime Kuma.

### 10. Logging & Observability

* Structured JSON logs (`pino`) shipped to Grafana Loki.
* Trace parent‑child spans (`OpenTelemetry`), surfacing in Jaeger Tempo.

### 11. Internationalization & Accessibility

* Content via i18next, locale files lazy‑loaded.
* Focus traps, ARIA labels, prefers‑color‑scheme dark/light.
* RTL mirrored flex with `dir="rtl"` attribute toggle.

### 12. Extension Points

* Plugin system via `postMessage` into an iframe sandbox.
* WebHook on task state change.
* Public embed mode (`?embed=true`) renders read‑only list.

### 13. Open Questions

* Should guest tasks auto‑delete after X days?
* Prioritize GraphQL vs REST first?
* Multi‑factor auth requirement?

---

*End of Document* 